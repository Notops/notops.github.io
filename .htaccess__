# Блокирования открытия файла на чтение\запись по полному пути
php_value allow_url_fopen 0
php_value display_errors 0

# Блокирование показа папки при отсутствии в ней индексных файлов
Options -Indexes

# Все отображаемые данные имеют кодировку utf-8
AddDefaultCharset utf-8
AddCharset UTF-8 .css

# Обработка ошибок собственным скриптом. Размер файла скрипта
# должен быть больше 1 КБ
#
# В errors.php через $_SERVER['REQUEST_URI'] определяем
# какой документ вызвал ошибку и дальше обрабатываем.
ErrorDocument 403 /errors.php?403
ErrorDocument 404 /errors.php?404
ErrorDocument 500 /errors.php?500

# Запрет на обращение к файлу errors_log.txt
<Files errors_log.txt>
Deny from all
</Files>

# Запрет на обращение к файлу version.txt
<Files version.txt>
Deny from all
</Files>

# Запрет на обращение к файлам .tpl
<Files "*.tpl">
Deny from all
</Files>

# Правила для ЧПУ
RewriteEngine On
Options +FollowSymLinks

RewriteCond %{HTTP_USER_AGENT} ^EmailSiphon [OR]
RewriteCond %{HTTP_USER_AGENT} ^ExtractorPro
RewriteRule ^.*$ - [F]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# http://domain.ru/index.php?module=show&content=news
# http://domain.ru/news
RewriteRule ^([^/]*)$ ./index.php?module=show&content=$1 [L]

# http://domain.ru/index.php?module=show&content=mylist&print=1&printlist=1
# http://domain.ru/mylist/print
RewriteRule ^([^/]*)/print$ ./index.php?module=show&content=$1&print=1&printlist=1 [L]

# http://domain.ru/index.php?module=show&content=news&date=2009&page=3
# http://domain.ru/index.php?module=show&content=news&date=2009_08&page=3
# http://domain.ru/news/date/2009/page/3
# http://domain.ru/news/date/2009_08/page/3
RewriteRule ^([^/]*)/date/([^/]*)/page/([^/]*)$ ./index.php?module=show&content=$1&date=$2&page=$3 [L]

# http://domain.ru/index.php?module=show&content=news&page=3
# http://domain.ru/news/page/3
RewriteRule ^([^/]*)/page/([^/]*)$ ./index.php?module=show&content=$1&page=$2 [L]

# http://domain.ru/index.php?module=show&content=news&date=2009
# http://domain.ru/index.php?module=show&content=news&date=2009_08
# http://domain.ru/news/date/2009
# http://domain.ru/news/date/2009_08
RewriteRule ^([^/]*)/date/([^/]*)$ ./index.php?module=show&content=$1&date=$2 [L]

# http://domain.ru/index.php?module=post
# http://domain.ru/module/post
RewriteRule ^module/([^/]*)$ ./index.php?module=$1 [L]

# http://domain.ru/index.php?module=self&content=faq_ask
# http://domain.ru/self/faq_ask
RewriteRule ^self/([^/]*)$ ./index.php?module=self&content=$1 [L]

# http://domain.ru/index.php?module=pub&content=news&name_eng=novaya_novost
# http://domain.ru/news/novaya_novost
RewriteRule ^([^/]*)/([^/]*)$ ./index.php?module=pub&content=$1&name_eng=$2 [L]

# http://domain.ru/index.php?module=pub&content=news&name_eng=novaya_novost&page=3
# http://domain.ru/news/novaya_novost/page/3
RewriteRule ^([^/]*)/([^/]*)/page/([^/]*)$ ./index.php?module=pub&content=$1&name_eng=$2&page=$3 [L]

# http://domain.ru/index.php?module=pub&content=news&name_eng=novaya_novost&print=1
# http://domain.ru/news/novaya_novost/print
RewriteRule ^([^/]*)/([^/]*)/print$ ./index.php?module=pub&content=$1&name_eng=$2&print=1 [L]

# http://domain.ru/index.php?module=show_category&content=pubcategory&name_eng=kategoriya
# http://domain.ru/pubcategory/category/kategoriya
RewriteRule ^([^/]*)/category/([^/]*)$ ./index.php?module=show_category&content=$1&name_eng=$2 [L]

# http://domain.ru/index.php?module=show_category&content=pubcategory&name_eng=kategoriya&page=3
# http://domain.ru/pubcategory/category/kategoriya/page/3
RewriteRule ^([^/]*)/category/([^/]*)/page/([^/]*)$ ./index.php?module=show_category&content=$1&name_eng=$2&page=$3 [L]

# http://domain.ru/index.php?module=category_data&content=pubcategory&cat=kategoriya&name_eng=novaya_novost
# http://domain.ru/pubcategory/category/kategoriya/novaya_novost
RewriteRule ^([^/]*)/category/([^/]*)/([^/]*)$ ./index.php?module=category_data&content=$1&cat=$2&name_eng=$3 [L]

# http://domain.ru/index.php?module=category_data&content=pubcategory&cat=kategoriya&name_eng=novaya_novost&page=3
# http://domain.ru/pubcategory/category/kategoriya/novaya_novost/page/3
RewriteRule ^([^/]*)/category/([^/]*)/([^/]*)/page/([^/]*)$ ./index.php?module=category_data&content=$1&cat=$2&name_eng=$3&page=$4 [L]

# http://domain.ru/index.php?module=logins&do=log
# http://domain.ru/module/logins/log
RewriteRule ^module/([^/]*)/([^/]*)$ ./index.php?module=$1&do=$2 [L]

# http://domain.ru/index.php?module=search&do=query&page=2
# http://domain.ru/module/search/query/page/2
RewriteRule ^module/([^/]*)/([^/]*)/page/([^/]*)$ ./index.php?module=$1&do=$2&page=$3 [L]