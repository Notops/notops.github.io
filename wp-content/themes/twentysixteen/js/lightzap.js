/* LightZAP v2.54a
	by Szalai Mihaly - http://dragonzap.szunyi.com */
﻿
//----- Options --------
var	imagetext	= "",	//"Image "
	oftext		= " / ",//" of "
	bytext		= "by",	//"by"
	notfoundtext	= "Image not found",
	print		= false,
	download	= false,
	like		= false,
	circling	= true;
//----------------------
var c,s,t,u,v,w,x,A,B,C,D=[],E="",F=0,G=!1,H=-1,I=-1,J="hq",K=["webkit","moz","ms","o",""];function M(a,b){return a.getElementsByClassName?a.getElementsByClassName(b):document.querySelectorAll("."+b)} window.onload=function(){N();for(var a=["IsFullScreen","FullScreen"],b=["CancelFullScreen","RequestFullScreen"],e,g,l="undefined",q=0;q<K.length&&!document[g];){for(e=0;e<a.length;){g=a[e];""==K[q]&&(g=g.substr(0,1).toLowerCase()+g.substr(1),b[0]=b[0].substr(0,1).toLowerCase()+b[0].substr(1),b[1]=b[1].substr(0,1).toLowerCase()+b[1].substr(1));g=K[q]+g;l=typeof document[g];if("undefined"!=l){K=[K[q]+b[0],K[q]+b[1],g];q=2;break}e++}q++}s=document.createElement("div");s.id="lightzap";s.style.display= "none";document.body.appendChild(s);w=document.createElement("div");w.className="lz-bg";w.onclick=O;s.appendChild(w);t=document.createElement("div");t.className="lz-container";s.appendChild(t);a=document.createElement("div");a.className="lz-loader";t.appendChild(a);u=document.createElement("img");u.className="lz-image";t.appendChild(u);b=document.createElement("div");b.className="lz-nav";t.appendChild(b);a=document.createElement("a");a.className="lz-prev";a.onclick=function(){P(F+1);return!1};b.appendChild(a); a=document.createElement("a");a.className="lz-next";a.onclick=function(){P(F-1);return!1};b.appendChild(a);b=document.createElement("div");b.className="lz-buttonContainer";t.appendChild(b);a=document.createElement("a");a.className="lz-button lz-more";a.onclick=function(){"none"==M(t,"lz-desc")[0].style.display?M(t,"lz-desc")[0].style.display="":M(t,"lz-desc")[0].style.display="none";return!1};b.appendChild(a);a=document.createElement("a");a.className="lz-button lz-print";a.onclick=Q;b.appendChild(a); a=document.createElement("a");a.className="lz-button lz-download";a.onclick=R;a.target="_blank";b.appendChild(a);a=document.createElement("a");a.className="lz-button lz-like";a.onclick=S;b.appendChild(a);3!=q?K=!1:(a=document.createElement("div"),a.className="lz-button lz-fullScreen",a.onclick=function(){if(G)document[K[0]]();else s[K[1]]()},b.appendChild(a));a=document.createElement("a");a.className="lz-button lz-close";a.onclick=O;b.appendChild(a);v=document.createElement("div");v.className="lz-labelContainer"; t.appendChild(v);a=document.createElement("div");a.className="lz-float lz-caption";v.appendChild(a);a=document.createElement("div");a.className="lz-float lz-desc";a.style.display="none";v.appendChild(a);a=document.createElement("div");a.className="lz-float lz-resolution";v.appendChild(a);a=document.createElement("a");a.className="lz-float lz-by";a.target="_blank";v.appendChild(a);a=document.createElement("div");a.className="lz-float lz-number";v.appendChild(a)}; function N(){for(var a=document.links,b=a.length;b--;){var e=a[b];null!=e.getAttribute("data-lightzap")&&(e.onclick=function(){T(!1);U();s.style.display="";window.onresize=U;if(-1==H){c=window.getComputedStyle(u,"").getPropertyValue("background-image").replace("url(","").replace(")","").replace('"',"").replace('"',"");u.style.backgroundImage="none";var a=window.getComputedStyle(t,"");I=parseInt(a.getPropertyValue("margin-top"))+parseInt(a.getPropertyValue("margin-bottom"))+parseInt(a.getPropertyValue("padding-top"))+ parseInt(a.getPropertyValue("padding-bottom"))+parseInt(a.getPropertyValue("border-top-width"))+parseInt(a.getPropertyValue("border-bottom-width"));H=parseInt(a.getPropertyValue("margin-left"))+parseInt(a.getPropertyValue("margin-right"))+parseInt(a.getPropertyValue("padding-left"))+parseInt(a.getPropertyValue("padding-right"))+parseInt(a.getPropertyValue("border-left-width"))+parseInt(a.getPropertyValue("border-right-width"))}var b,e,y=0,z=this.getAttribute("data-lightzap");if(E==z||""==z)if(""== z)D=[],V(this);else for(y=D.length;y--&&D[y].link!=this.getAttribute("href"););else{D=[];e=document.links;b=e.length;for(var L=0;b--;)a=e[b],null!=a.getAttribute("data-lightzap")&&a.getAttribute("data-lightzap")==z&&(V(a),a.href==this.href&&(y=L),L++)}E=z;P(y);return !1})}} function V(a){var b=!1,e=!1,g=!1,l=a.getAttribute("data-options");null!=l&&3<l.length&&(b=-1!=l.indexOf("download"),e=-1!=l.indexOf("like"),g=-1!=l.indexOf("print"));D.push({link:a.getAttribute("href"),title:a.getAttribute("title"),c:a.getAttribute("data-desc"),b:a.getAttribute("data-by"),a:a.getAttribute("data-link"),d:b,print:g,e:e})} function P(a){0>a?a=D.length-1:a>D.length-1&&(a=0);document.onkeyup=W;s.className=(G?"full-screen ":"")+J+" lz-hide";var b=new Image;b.onload=function(){u.src=D[a].link;w.style.backgroundImage="url('"+D[a].link+"')";B=b.width;C=b.height;F=a;return X()};b.onerror=function(){D[a].title=notfoundtext;u.src=c;w.style.backgroundImage="none";C=B=256;F=a;return X()};b.src=D[a].link} function U(){var a,b;"number"==typeof window.innerWidth?(a=Math.min(window.innerWidth,document.body.clientWidth),b=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(a=document.documentElement.clientWidth,b=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(a=document.body.clientWidth,b=document.body.clientHeight);if(x!=a||A!=b)x=a,A=b,s.style.width=a,s.style.height= b,(G=!1!=K?"function"==typeof document[K[2]]?document[K[2]]():document[K[2]]:!1)?(s.className="full-screen "+J,s.style.width="",s.style.height="",t.style.height="100%",M(s,"lz-bg")[0].onclick=null):(M(s,"lz-bg")[0].onclick=O,s.className=J,t.style.width="",t.style.height=""),0<D.length&&X()} function X(){var a=x,b=A,e=B,g=C,l=t.style,q=u.style;G?(q=l,l=u.style,K&&(a=screen.width,b=screen.height)):(a-=H,b-=I);e>a&&(g=a*g/e,e=a);g>b&&(e=b*e/g,g=b);q.top="0";q.left="0";q.width="";q.height="";l.top=0.5*(b-g)+"px";l.left=0.5*(a-e)+"px";l.width=e+"px";l.height=g+"px";Y();20<(new Date).getTime()-startTime&&(J="")} function Y(){M(t,"lz-prev")[0].style.display="none";M(t,"lz-next")[0].style.display="none";if(0<F||circling)M(t,"lz-next")[0].style.display="";if(F<D.length-1||circling)M(t,"lz-prev")[0].style.display="";Z();var a;D.length>F+1&&(a=new Image,a.src=D[F+1].link);0<F&&(a=new Image,a.src=D[F-1].link);setTimeout(function(){s.className=(G?"full-screen ":" ")+J+" lz-show"},380)} function Z(){var a=M(v,"lz-number")[0];1<D.length?(a.textContent=imagetext+(D.length-F)+oftext+D.length,a.style.display=""):a.style.display="none";a=M(v,"lz-caption")[0];null!=D[F].title&&""!=D[F].title?(a.textContent=D[F].title,a.style.display=""):a.style.display="none";a=M(t,"lz-more")[0];null!=D[F].c&&""!=D[F].c?(a.style.display="",a=M(v,"lz-desc")[0],a.innerHTML=D[F].c,a.style.display="none"):(a.style.display="none",M(v,"lz-desc")[0].style.display="none");a=M(v,"lz-by")[0];null!=D[F].b&&""!=D[F].b?(a.innerHTML=bytext+" <span>"+D[F].b+"</span>",a.style.display="",null!=D[F].a&&""!=D[F].a&&(a.href=D[F].a)):(a.innerHTML="",a.style.display="none",null!=D[F].a&&""!=D[F].a&&M(t,".lz-caption").f()+"</a>");M(t,"lz-like")[0].style.display=D[F].e!=like&&u.src!=c?"":"none";M(t,"lz-download")[0].style.display=D[F].d!=download&&u.src!=c?"":"none";M(t,"lz-print")[0].style.display=D[F].print!=print&&u.src!=c?"":"none";M(v,"lz-resolution")[0].textContent=B+" x "+C} function W(a){27==a.keyCode||88==a.keyCode?O():78==a.keyCode||39==a.keyCode?(0!=F||circling)&&P(F-1):80!=a.keyCode&&37!=a.keyCode||F==D.length-1&&!circling||P(F+1)} function Q(){win=window.open();self.focus();win.document.open();win.document.write("<html><body stlye='margin:0 auto;padding:0;'><h1 style='margin:0 0 0.48em;'>"+M(t,"lz-caption")[0].textContent+"</h1><div style='text-align:center;'><img src='"+u.src+"' style='max-height:23.2cm;max-width:100%;'/></div><div style='text-align:right;'><i>"+M(t,"lz-by")[0].textContent+"</i></div></body></html>");win.document.close();win.print();win.close()} function S(){if(!window.focus)return!0;window.open("http://www.facebook.com/sharer/sharer.php?u="+u.src,"","width=400,height=200,scrollbars=yes")} function R(){if(window.webkitURL){var a=new XMLHttpRequest;a.open("GET",D[F].link);a.responseType="blob";a.onreadystatechange=function(){var b=document.createElement("a");b.href=window.URL?window.URL.createObjectURL(a.response):window.webkitURL.createObjectURL(a.response);b.d=D[F].link.substring(D[F].link.lastIndexOf("/")+1);var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null);b.dispatchEvent(e)};a.send();return!0}if("Microsoft Internet Explorer"== navigator.appName)return win=window.open(D[F].link),self.focus(),win.document.execCommand("SaveAs"),win.close(),!0;var b=document.createElement("canvas");document.body.appendChild(b);if("undefined"!=typeof b.getContext)try{var e=b.getContext("2d");b.width=Math.min(B,1024);b.height=Math.min(C,1024*(C/B));b.style.width=b.width+"px";b.style.height=b.height+"px";e.drawImage(u,0,0,b.width,b.height);document.location.href=b.toDataURL("image/png").replace("image/png","image/octet-stream");document.body.removeChild(b); return!0}catch(g){document.body.removeChild(b)}alert("Sorry, can't download")}function O(){if(G&&!1!=K)document[K[0]]();document.onkeypress=null;window.onresize=null;s.style.display="none";T(!0);return!1}function T(a){var b,e,g=["select","object","embeds"],l=3;for(a=a?"visible":"hidden";l--;)for(b=document.getElementsByTagName(g[l]),e=b.length;e--;)b[e].style.visibility=a};
